<!DOCTYPE html>
<html>

<!-- Mirrored from 127.0.0.1:4567/services/Route-Collector by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 15 Aug 2022 13:08:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
  <meta http-equiv="Content-type" content="text/html;charset=utf-8">
  <meta name="MobileOptimized" content="width">
  <meta name="HandheldFriendly" content="true">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" type="text/css" href="../gollum/assets/app-309be032396e783b13a47df58f389b7c8e11c2b2d42640560b874f677c25f6e5.css" media="all">
  <link rel="stylesheet" type="text/css" href="../gollum/assets/print-512498c368be0d3fb1ba105dfa84289ae48380ec9fcbef948bd4e23b0b095bfb.css" media="print">

  <link rel="stylesheet" type="text/css" href="../custom.css" media="all">
  

  <script>
  var criticMarkup = '';
	var baseUrl = '';
  var showLocalTime = false;
	var uploadDest = 'uploads';
	var perPageUploads = '';
	if (perPageUploads == 'true') {
	  uploadDest = uploadDest + window.location.pathname.replace(/.*gollum\/[-\w]+\//, "/").replace(/\.[^/.]+$/, "").replace(baseUrl, "")
	}
	  var pageFullPath = 'services/Route-Collector.md';
    var pageFormat   = 'markdown';

  </script>
  <script src="../gollum/assets/app-f05401ee374f0c7f48fc2bc08e30b4f4db705861fd5895ed70998683b383bfb5.js" type="text/javascript"></script>
  

  <title>Route-Collector</title>
</head>
<body>
<div class="container-lg clearfix">
<div id="wiki-wrapper" class="page">
<div id="head">
	<nav class="TableObject
            actions
            border-bottom
            border-md-0
            p-2
            pt-lg-4
            px-lg-0
            overflow-x-scroll">
  <div class="TableObject-item hide-lg hide-xl">
    <details class="details-reset details-overlay">
      <summary class="btn btn-invisible" aria-haspopup="true">
        <span aria-label="Open menu">â˜°</span>
      </summary>
    
      <div class="SelectMenu mx-sm-2">
        <div class="SelectMenu-modal">
          <div class="SelectMenu-divider py-3">
            <h2 class="h6">Current Page</h2>
            <div>Route-Collector</div>
          </div>
    
            <a
              class="SelectMenu-item"
              href="../gollum/history/services/Route-Collector.html"
              role="menuitem"
            >
              <span>History</span>
            </a>
    
    
          <div class="SelectMenu-divider py-3">
            <h2 class="h6">Main Menu</h2>
          </div>
    
          <div class="SelectMenu-list">
            <a class="SelectMenu-item" role="menuitem" href="../index.html">
              Home
            </a>
    
              <a class="SelectMenu-item" role="menuitem" href="../gollum/overview.html">
                Overview
              </a>
    
              <a
                class="SelectMenu-item"
                href="../gollum/latest_changes.html"
                role="menuitem"
              >
                Latest Changes
              </a>
          </div>
        </div>
      </div>
    </details>
  </div>

  <div class="TableObject-item hide-sm hide-md">
    <a class="btn btn-sm" id="minibutton-home" href="../index.html">
      Home
    </a>
  </div>

  <div
    class="TableObject-item TableObject-item--primary px-2"
    
  >
    <form class="search-form" action="http://127.0.0.1:4567/gollum/search" method="get" id="search-form">
    	<input type="text" class="form-control input-block" name="q" id="search-query" placeholder="Search" aria-label="Search site" autocomplete="off">
    </form>  </div>

  <div class="TableObject-item hide-sm hide-md">
    <div class="BtnGroup d-flex">
        <a
          class="btn BtnGroup-item btn-sm"
          href="../gollum/overview.html"
          id="minibutton-overview"
        >
          Overview
        </a>

        <a
          class="btn BtnGroup-item btn-sm"
          href="../gollum/latest_changes.html"
          id="minibutton-latest-changes"
        >
          Latest Changes
        </a>
    </div>
  </div>

  <div class="TableObject-item px-2">
    <div class="BtnGroup d-flex">
        <a
          class="btn BtnGroup-item btn-sm hide-sm hide-md"
          href="../gollum/history/services/Route-Collector.md/index.html"
          id="minibutton-history"
        >
          History
        </a>

    </div>
  </div>

</nav>

</div>

<div id="wiki-content" class="px-2 px-lg-0">
  <h1 class="header-title text-center text-md-left pt-4">
    Route-Collector
  </h1>
	<div class="breadcrumb"><nav aria-label="Breadcrumb"><ol>
<li class="breadcrumb-item"><a href="../gollum/overview/services/index.html">services</a></li>
</ol></nav></div>

	<div class="has-header has-footer has-sidebar has-rightbar">
	  <div id="wiki-body" class="gollum-markdown-content">
	    <div id="wiki-header" class="gollum-markdown-content">
	      <div id="header-content" class="markdown-body">
	        <p><a href="../index.html" rel="nofollow"><img src="../dn42.png" alt="dn42" /></a></p>

	      </div>
	    </div>
	    <div class="main-content clearfix container-lg">
	      <div class="markdown-body  float-md-left col-md-9" >
	        
	        <h1><a class="anchor" id="global-route-collector" href="#global-route-collector"></a>Global Route Collector</h1>

<p>The Global Route Collector (GRC) provides a real time view of routing and peering across DN42 and can be used to generate maps, stats or just query how routes are being propagated across the network. </p>

<p>Technically the GRC is a <a href="https://bird.network.cz/">bird</a> instance that anyone can peer with, it imports all routes whilst exporting none and provides a number of interfaces for querying the route data.</p>

<p>Data from the GRC is used to generate some of the DN42 Maps (see the <a href="../internal/Internal-Services.html">Internal Services</a> page).</p>

<h2><a class="anchor" id="peering-with-the-collector" href="#peering-with-the-collector"></a>Peering with the collector</h2>

<p>The collector uses the dynamic peering capability in Bird2 to allow anyone to peer with it without any new server side configuration being required. The collector relies on users peering with it across the network so the more peers the better and the more comprehensive the collector data will be.</p>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">Details</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">ASN</td>
<td align="left">AS4242422602</td>
</tr>
<tr>
<td align="left">Hostname</td>
<td align="left">collector.dn42</td>
</tr>
<tr>
<td align="left">IPv4 Address</td>
<td align="left">172.20.129.4</td>
</tr>
<tr>
<td align="left">IPv6 Address</td>
<td align="left">fd42:4242:2601:ac12::1</td>
</tr>
</tbody>
</table>

<h3><a class="anchor" id="bgp-configuration" href="#bgp-configuration"></a>BGP Configuration</h3>

<ul>
<li>Unlike normal DN42 peerings, you must enable multihop to peer with the collector</li>
<li>The collector supports Multiprotocol BGP, so you don't need to configure separate IPv4 and IPv6 sessions</li>
<li>Please enable the Add Paths BGP extension to export all available routes</li>
</ul>

<p>Example bird2 config:</p>

<pre class="highlight"><code>protocol bgp ROUTE_COLLECTOR
{
  local as ***YOUR_ASN***;
  neighbor fd42:4242:2601:ac12::1 as 4242422602;

  # enable multihop as the collector is not locally connected
  multihop;

  ipv4 {
    # export all available paths to the collector    
    add paths tx;

    # import/export filters
    import none;
    export filter {
      # export all valid routes
      if ( is_valid_network() &amp;&amp; source ~ [ RTS_STATIC, RTS_BGP ] )
      then {
        accept;
      }
      reject;
    };
  };

  ipv6 {
    # export all available paths to the collector    
    add paths tx;

    # import/export filters
    import none;
    export filter {
      # export all valid routes
      if ( is_valid_network_v6() &amp;&amp; source ~ [ RTS_STATIC, RTS_BGP ] )
      then {
        accept;
      }
      reject;
    };
  };
}</code></pre>

<h2><a class="anchor" id="querying-the-collector" href="#querying-the-collector"></a>Querying the collector</h2>

<h3><a class="anchor" id="looking-glass" href="#looking-glass"></a>Looking Glass</h3>

<p>The collector runs a looking glass based on <a href="https://github.com/xddxdd/bird-lg-go">bird-lg-go</a>. </p>

<ul>
<li><a href="https://lg.collector.dn42/">https://lg.collector.dn42/</a></li>
</ul>

<h3><a class="anchor" id="mrt-dumps" href="#mrt-dumps"></a>MRT Dumps</h3>

<p><a href="https://tools.ietf.org/html/rfc6396">MRT Dumps</a> are produced by the collector every 10 minutes. Bird produces MRT dumps corresponding to tables, so two separate dumps are created, one for IPv4 (master4) and one for IPv6 (master6). The 10 minutes dumps are available for one week before being reduced down to one a day. </p>

<ul>
<li><a href="https://mrt.collector.dn42/">https://mrt.collector.dn42</a></li>
</ul>

<p>The latest dumps can always be found at the following URLs:</p>

<ul>
<li><a href="https://mrt.collector.dn42/master4_latest.mrt.bz2">https://mrt.collector.dn42/master4_latest.mrt.bz2</a></li>
<li><a href="https://mrt.collector.dn42/master6_latest.mrt.bz2">https://mrt.collector.dn42/master6_latest.mrt.bz2</a></li>
</ul>

<h3><a class="anchor" id="prometheus-metrics" href="#prometheus-metrics"></a>Prometheus Metrics</h3>

<p>The collector runs <a href="https://github.com/czerwonk/bird_exporter">bird_exporter</a> and prometheus style metrics are available at the following URL:</p>

<ul>
<li><a href="http://collector.dn42:9324/metrics">http://collector.dn42:9324/metrics</a></li>
</ul>

<h3><a class="anchor" id="flapping-routes-in-maintenance" href="#flapping-routes-in-maintenance"></a>
<del>Flapping routes</del> (In maintenance)</h3>

<p><del>A real time view showing the number of route updates is available to help identify where routes are flapping:</del></p>

<ul>
<li><del><a href="https://flaps.collector.dn42/">https://flaps.collector.dn42/</a></del></li>
</ul>

<h3><a class="anchor" id="ssh-interface" href="#ssh-interface"></a>SSH Interface</h3>

<p>The collector bird instance can be queried directly using a birdc shell.</p>

<ul>
<li>ssh shell@collector.dn42</li>
</ul>

<pre class="highlight"><code><span class="nv">$ </span>ssh shell@collector.dn42
<span class="nt">------------------------------------</span>
<span class="k">*</span>    DN42 Global Route Collector   <span class="k">*</span>
<span class="nt">------------------------------------</span>
<span class="k">*</span> http://collector.dn42/

This service provides a bird2 shell
<span class="k">for </span>querying the route collector

Be <span class="nb">nice</span>, access is logged and
abuse will not be tolerated
<span class="nt">------------------------------------</span>
BIRD burble-2.0.8-210322-1-ge6133456 ready.
Access restricted
bird&gt; show route count
bird&gt;       297441 of 297441 routes <span class="k">for </span>502 networks <span class="k">in </span>table master4
286007 of 286007 routes <span class="k">for </span>427 networks <span class="k">in </span>table master6
1437 of 1437 routes <span class="k">for </span>1437 networks <span class="k">in </span>table dn42_roa4
1231 of 1231 routes <span class="k">for </span>1231 networks <span class="k">in </span>table dn42_roa6
Total: 586116 of 586116 routes <span class="k">for </span>3597 networks <span class="k">in </span>4 tables
bird&gt; 
</code></pre>

	      </div>
          <div id="wiki-sidebar" class="Box Box--condensed float-md-left col-md-3">
	        <div id="sidebar-content" class="gollum-markdown-content markdown-body px-4">
	          <ul>
<li>
<a href="../Home.html" rel="nofollow">Home</a>

<ul>
<li><a href="../howto/Getting-Started.html" rel="nofollow">Getting Started</a></li>
<li><a href="../howto/Registry-Authentication.html" rel="nofollow">Registry Authentication</a></li>
<li><a href="../howto/Address-Space.html" rel="nofollow">Address Space</a></li>
<li><a href="../howto/Bird-communities.html" rel="nofollow">BGP communities</a></li>
<li><a href="../FAQ.html" rel="nofollow">FAQ</a></li>
</ul>
</li>
</ul>

<ul>
<li>
<p>How-To</p>

<ul>
<li><a href="../howto/wireguard.html" rel="nofollow">Wireguard</a></li>
<li><a href="../howto/openvpn.html" rel="nofollow">Openvpn</a></li>
<li><a href="../howto/IPsec-with-PublicKeys.html" rel="nofollow">IPsec With Public Keys</a></li>
<li><a href="../howto/tinc.html" rel="nofollow">Tinc</a></li>
<li><a href="../howto/GRE-on-FreeBSD.html" rel="nofollow">GRE on FreeBSD</a></li>
<li><a href="../howto/GRE-on-OpenBSD.html" rel="nofollow">GRE on OpenBSD</a></li>
<li><a href="../howto/IPv6-Multicast.html" rel="nofollow">IPv6 Multicast (PIM-SM)</a></li>
<li>
<a href="../howto/Bird.html" rel="nofollow">Bird</a> / <a href="../howto/Bird2.html" rel="nofollow">Bird2</a>
</li>
<li><a href="../howto/Quagga.html" rel="nofollow">Quagga</a></li>
<li><a href="../howto/OpenBGPD.html" rel="nofollow">OpenBGPD</a></li>
<li><a href="../howto/mikrotik.html" rel="nofollow">Mikrotik RouterOS</a></li>
<li><a href="../howto/EdgeOS-Config.html" rel="nofollow">EdgeRouter</a></li>
<li><a href="../howto/Static-routes-on-Windows.html" rel="nofollow">Static routes on Windows</a></li>
<li><a href="../howto/networksettings.html" rel="nofollow">Universal Network Requirements</a></li>
<li><a href="../howto/vyos.html" rel="nofollow">VyOS</a></li>
<li><a href="../howto/nixos.html" rel="nofollow">NixOS</a></li>
</ul>
</li>
<li>
<p>Services</p>

<ul>
<li><a href="IRC.html" rel="nofollow">IRC</a></li>
<li><a href="Whois.html" rel="nofollow">Whois registry</a></li>
<li><a href="DNS.html" rel="nofollow">DNS</a></li>
<li><a href="Clearnet-Domains.html" rel="nofollow">Public DNS</a></li>
<li><a href="Looking-Glasses.html" rel="nofollow">Looking Glasses</a></li>
<li><a href="Automatic-Peering.html" rel="nofollow">Automatic Peering</a></li>
<li><a href="Repository-Mirrors.html" rel="nofollow">Repository Mirrors</a></li>
<li><a href="Distributed-Wiki.html" rel="nofollow">Distributed Wiki</a></li>
<li><a href="Certificate-Authority.html" rel="nofollow">Certificate Authority</a></li>
<li><a href="Route-Collector.html" rel="nofollow">Route Collector</a></li>
</ul>
</li>
<li>
<p>Internal</p>

<ul>
<li><a href="../internal/Internal-Services.html" rel="nofollow">Internal services</a></li>
<li><a href="../internal/Interconnections.html" rel="nofollow">Interconnections</a></li>
<li><a href="../internal/APIs.html" rel="nofollow">APIs</a></li>
<li>
<a href="../internal/ShowAndTell.html" rel="nofollow">Show and Tell</a><br />
</li>
<li><a href="../internal/Historical-Services.html" rel="nofollow">Historical services</a></li>
</ul>
</li>
<li>
<p>External Tools</p>

<ul>
<li><a href="https://paste.dn42.us/" rel="nofollow">Paste Board</a></li>
<li><a href="https://git.dn42.dev/" rel="nofollow">Git Repositories</a></li>
</ul>
</li>
</ul>

<hr />

	        </div>
	      </div>
	    </div>
	  </div>
	  <div id="wiki-footer" class="gollum-markdown-content my-2">
	    <div id="footer-content" class="Box Box-condensed markdown-body px-4">
	      <p>Hosted by: <a href="mailto:xuu@sour.is" rel="nofollow">xuu</a>, <a href="mailto:nurtic-vibe@grmml.net" rel="nofollow">nurtic-vibe</a>, <a href="mailto:tom@xcv.vc" rel="nofollow">toBee</a>, <a href="mailto:dn42@burble.com" rel="nofollow">burble</a> | Accessible via: <a href="https://wiki.dn42/" rel="nofollow">dn42</a>, <a href="https://dn42.eu/" rel="nofollow">dn42.eu</a>, <a href="https://dn42.dev/" rel="nofollow">dn42.dev</a></p>

	    </div>
	  </div>


	</div>


	<div id="footer" class="pt-4">
		  <p id="last-edit"><div class="dotted-spinner hidden"></div> <a id="page-info-toggle" data-pagepath="services/Route-Collector.md">When was this page last modified?</a></p>
	</div>


</div>

<form name="rename" method="POST" action="http://127.0.0.1:4567/gollum/rename/services/Route-Collector.md">
  <input type="hidden" name="rename"/>
  <input type="hidden" name="message"/>
</form>

</div>
</div>
</body>

<!-- Mirrored from 127.0.0.1:4567/services/Route-Collector by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 15 Aug 2022 13:08:48 GMT -->
</html>
